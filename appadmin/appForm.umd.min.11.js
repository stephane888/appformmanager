(("undefined"!==typeof self?self:this)["webpackJsonpappForm"]=("undefined"!==typeof self?self:this)["webpackJsonpappForm"]||[]).push([[11],{"169f":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("b-row",{attrs:{"align-h":"center"}},[t.formDatas&&t.formDatas.info?s("b-col",{attrs:{cols:"12",lg:"10"}},[s("div",[s("title-bar",{attrs:{conf:{col:!0,text:"Configuration du formulaire"},id:t.id}}),s("nav-line",{attrs:{taille:t.id}}),s("loaderIcon",{attrs:{busy:t.isComplete}}),t.isComplete?t._e():s("FormStep")],1)]):t._e(),t.$store.state.mode?s("b-col",{attrs:{cols:"12",lg:"2"}},[s("div",{staticClass:"block-button"},[s("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-prevent-closing",modifiers:{"modal-prevent-closing":!0}}],staticClass:"shadow-md d-block w-100",attrs:{variant:"light",squared:""}},[t._v(" Configuration ")]),s("b-button",{staticClass:"shadow-md d-block w-100",attrs:{squared:"",variant:"light"},on:{click:t.clearFormDatas}},[t._v(" Ajouter une etape ")]),s("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.re-order-stepes",modifiers:{"re-order-stepes":!0}}],staticClass:"shadow-md d-block w-100",attrs:{squared:"",variant:"light"}},[t._v(" Re-ordonner les etapes ")]),s("b-button",{staticClass:"shadow-md d-block w-100",attrs:{squared:"",variant:"secondary"},on:{click:t.resetValue}},[t._v(" Reset value ")]),s("b-button",{staticClass:"shadow-md d-block w-100",attrs:{squared:"",variant:"success"},on:{click:t.saveToLocal}},[t._v(" Enregistrer ")]),s("b-button",{staticClass:"shadow-md d-block w-100",attrs:{squared:"",variant:"dark"},on:{click:t.exportJson}},[t._v(" Export to json ")]),s("b-modal",{ref:"modal",attrs:{id:"modal-prevent-closing",title:"Edition du formulaire","hide-footer":""},on:{show:t.resetModal,hidden:t.resetModal,ok:t.handleOk}},[t.formDatas&&t.formDatas.info?s("form",{ref:"form",on:{submit:t.handleSubmit,reset:t.resetModal}},[s("b-row",[s("b-col",{attrs:{cols:"8"}},[s("b-form-group",{attrs:{label:"name","label-for":"name-input"}},[s("b-form-input",{attrs:{id:"db-input",required:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),s("b-col",{attrs:{cols:"8"}},[s("b-form-group",{attrs:{label:"Id","label-for":"description-input"}},[s("b-form-input",{attrs:{id:"desc-input-id"},model:{value:t.form.id,callback:function(e){t.$set(t.form,"id",e)},expression:"form.id"}})],1)],1),s("b-col",{attrs:{cols:"8"}},[s("b-form-group",{attrs:{label:"Description","label-for":"description-input"}},[s("b-form-textarea",{attrs:{id:"desc-input",required:""},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)],1),s("b-col",{attrs:{cols:"12"}},[s("b-form-group",{attrs:{label:"image","label-for":"description-input"}},[s("UploadImage",{attrs:{field:t.form}})],1)],1)],1),s("hr",{staticClass:"my-3"}),s("b-row",{attrs:{"align-h":"end"}},[s("div",{staticClass:"mr-3"},[s("b-button",{staticClass:"mr-2"},[t._v(" export ")]),s("b-button",{staticClass:"mr-2",attrs:{type:"submit",variant:"primary"}},[t._v(" Mise à jour ")])],1)])],1):t._e()])],1)]):t._e()],1),s("reOrderStepes")],1)},o=[],r=s("f3f3"),i=(s("e260"),s("d3b7"),s("e6cf"),s("3ca3"),s("ddb0"),s("a434"),s("2b3d"),s("9861"),s("a15b"),s("caad"),s("63c9")),n=s("f158"),l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"nav-line"},t._l(t.idLevel,(function(e,a){return s("div",{key:a,staticClass:"w-100"},[s("b-button",{staticClass:"nav-line__nav",class:a==t.stepsIndex?"nav-line__nav--dark":"nav-line__nav--normal",attrs:{title:"Etape "+a,variant:"primary",id:"tooltip-1"+a},on:{click:function(e){return t.loadSteps(a)}}}),s("b-tooltip",{attrs:{target:"tooltip-1"+a,triggers:"hover",variant:"info"}},[s("b",[t._v("etape "+t._s(a))]),t._v(" "),s("br"),s("div",[t._v(t._s(t.form.forms[a].info.title))])])],1)})),0)},d=[],c=(s("a9e3"),s("2f62")),u={props:{taille:{require:!0}},components:{},data:function(){return{value:1}},watch:{taille:function(){}},mounted:function(){var t=localStorage.getItem("step"),e=localStorage.getItem("id");null!==e&&t.length&&e==this.taille?this.$store.state.stepsIndex=Number(t):this.$store.state.stepsIndex=0},computed:Object(r["a"])(Object(r["a"])({},Object(c["c"])(["stepsIndex","form"])),{},{idLevel:function(){var t=[];if(this.form.forms&&this.form.forms.length)for(var e in this.form.forms)t.push(e);return t}}),methods:{loadSteps:function(t){this.$store.state.stepsIndex=t,localStorage.setItem("step",t),localStorage.setItem("id",this.taille)}}},f=u,m=(s("3734"),s("2877")),p=Object(m["a"])(f,l,d,!1,null,null,null),b=p.exports,h=s("0b7d"),v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("b-modal",{ref:"modal",attrs:{id:"re-order-stepes",title:"Re-ordonner les etapes","hide-footer":"",size:"lg"}},[s("b-list-group",t._l(t.form.forms,(function(e,a){return s("b-list-group-item",{key:a},[s("div",{staticClass:"d-flex align-items-center"},[s("b-button",{staticClass:"border-0",attrs:{variant:"outline-info"},on:{click:function(e){return t.modeToUp(a)}}},[s("b-icon",{attrs:{icon:"arrow-bar-up"}})],1),s("b-button",{staticClass:"border-0",attrs:{variant:"outline-info"},on:{click:function(e){return t.moveToDown(a)}}},[s("b-icon",{attrs:{icon:"arrow-bar-down"}})],1),s("div",{staticClass:"pl-5",class:[e.states&&e.states.length>0?"ml-5":""]},[t._v(" "+t._s(a)+" : "+t._s(e.info.title)+" "),e.states&&e.states.length>0?s("div",t._l(e.states,(function(e,a){return s("div",{key:a},[s("small",[t._v(" "+t._s(t.getNameStep(e.state_name))+" ")])])})),0):t._e()])],1)])})),1),s("div",{staticClass:"justify-content-end d-flex"},[s("div",{staticClass:"mx-2 my-4"},[s("b-button",{attrs:{type:"submit",variant:"primary"},on:{click:function(e){return t.$bvModal.hide("re-order-stepes")}}},[t._v(" Mettre à jour ")])],1)])],1)],1)},g=[],_=(s("b0c0"),s("2c10")),w={name:"reOrderStepes",props:{},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:Object(r["a"])({},Object(c["c"])(["form"])),methods:{moveToDown:function(t){var e=t+1;_["a"].array_move(this.form.forms,t,e)},modeToUp:function(t){var e=t-1;_["a"].array_move(this.form.forms,t,e)},getNameStep:function(t){for(var e in this.form.forms)if(this.form.forms[e].info.name===t)return this.form.forms[e].info.title}}},S=w,D=Object(m["a"])(S,v,g,!1,null,"494ba7f9",null),x=D.exports,k=s("021a"),y={components:{FormStep:h["a"],NavLine:b,reOrderStepes:x,TitleBar:i["a"],loaderIcon:k["a"],UploadImage:function(){return Promise.all([s.e(0),s.e(7)]).then(s.bind(null,"9353"))}},props:{id:{type:String,required:!0}},data:function(){return{datasBd:[],stepsId:1,demo:!0,title:"",datasBase:{description:"",id:null,forms:"",name:""},busy:!1}},watch:{stepsId:function(){this.datasBdOrLocalStorage()}},mounted:function(){var t=this;this.$store.dispatch("setFormId",this.id),this.$store.dispatch("loadFormsDatas"),this.busy=!0,this.$store.dispatch("loadStepsDatas",{formId:this.id}).then((function(){t.busy=!1}))},computed:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(c["c"])(["stepsIndex","allStepsDatas","fields","price","mode","priceAide","items","form"])),Object(c["b"])(["formDatas"])),{},{currentSteps:function(){var t=localStorage.getItem("allo"),e=JSON.parse(t);return null!=e&&e.length?e[this.stepsIndex]:this.formDatas},stepsDatas:function(){var t=this.datasBd;return this.datasBd.length?(console.log("object io",t[this.stepsId-1]),t[this.stepsId-1]):"vide"},isComplete:function(){return!(this.formDatas&&this.formDatas.fields.length||!this.busy)}}),methods:{deleteSteps:function(t){var e=this.$store.state.allStepsDatas,s=e.indexOf(this.formDatas);this.$emit("index-to-delete",s),console.log("de",t);for(var a=e.length-1;a>=0;a--)a===s&&(e.splice(a,1),console.log("iiippp"))},datasBdOrLocalStorage:function(){var t=localStorage.getItem("allo"),e=JSON.parse(t);if(console.log("loaaaa",e),"vide"!=this.stepsDatas){this.datasBase=this.stepsDatas,console.log("aaa",this.datasBase);var s=JSON.parse(this.datasBase.forms);this.$store.state.allStepsDatas=s,this.$store.state.formDatas=this.allStepsDatas[this.stepsIndex]}else null!=e&&e.length?(console.log("appppaaa",e),this.$store.state.allStepsDatas=e,this.$store.state.formDatas=this.allStepsDatas[this.stepsIndex]):"vide"==this.stepsDatas&&alert("Désolé nous n'avons pas pue accéder à la BD  et vous n'avez aucune données dans votre localStorage")},saveToLocal:function(){var t=this;this.busy=!0,n["a"].prepareDatasToSave(this.form).then((function(e){n["a"].saveForm(e,t.mode).then((function(){t.busy=!1})).catch((function(){t.busy=!1}))}))},exportJson:function(){var t=window.prompt("Veuillez renseigner le nom du fichier","test").toLowerCase(),e=JSON.stringify(this.form),s=new Blob([e],{type:"text/plain"}),a=document.createEvent("MouseEvents"),o=document.createElement("a");o.download=t+".json",o.href=window.URL.createObjectURL(s),o.dataset.downloadurl=["text/json",o.download,o.href].join(":"),a.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(a)},clearFormDatas:function(){var t={info:{headerTitle:"",title:"",name:""},fields:[]};this.form.forms.push(t),this.$store.state.stepsIndex=this.form.forms.length-1},resetValue:function(){var t=["radio","text","select","number","radiodesc","codepostal"],e=["checkbox"];for(var s in this.formDatas.fields){var a=this.formDatas.fields[s];t.includes(a.type)?a.value=null:e.includes(a.type)?a.value=[]:"userlogin"===a.type&&(a.value=null)}},resetModal:function(){},handleOk:function(t){t.preventDefault(),this.handleSubmit()},handleSubmit:function(t){var e=this;t.preventDefault(),this.demo=!0,this.saveToLocal(),this.$nextTick((function(){e.$bvModal.hide("modal-prevent-closing")}))}}},I=y,C=(s("89b6"),Object(m["a"])(I,a,o,!1,null,null,null));e["default"]=C.exports},3734:function(t,e,s){"use strict";s("54f5")},"54f5":function(t,e,s){},"89b6":function(t,e,s){"use strict";s("cec3")},cec3:function(t,e,s){}}]);
//# sourceMappingURL=appForm.umd.min.11.js.map