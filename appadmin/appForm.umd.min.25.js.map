{"version":3,"sources":["webpack://appForm/./src/App/traitement/Traitement.vue?7579","webpack://appForm/src/App/traitement/Traitement.vue","webpack://appForm/./src/App/traitement/Traitement.vue?9bd8","webpack://appForm/./src/App/traitement/Traitement.vue","webpack://appForm/./src/App/traitement/Traitement.vue?2011"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","col","text","id","staticClass","ListeFieldsCheck","ListeFieldsDisplay","totalRows","isBusy","perPage","on","ChangePagination","staticRenderFns","components","props","type","String","required","data","watch","stepsId","datasBdOrLocalStorage","mounted","loadDatas","getTotalRows","computed","field","display_field","fieldsDisplay","push","label","key","name","thStyle","lists","i","methods","deleteSteps","all","$store","state","allStepsDatas","r","indexOf","formDatas","$emit","console","log","datas","length","splice","saveToLocal","config","resetValue","getters","selected","value","resetModal","handleOk","bvModalEvt","preventDefault","handleSubmit","event","demo","$nextTick","resp","nombres","pag","pagination","val","component"],"mappings":"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","file":"appForm.umd.min.25.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('b-container',{attrs:{\"fluid\":\"md\"}},[_c('div',[_c('title-bar',{attrs:{\"conf\":{ col: true, text: 'Traitement' },\"id\":_vm.id,\"showDevis\":false}})],1),_c('div',{staticClass:\"appfom-container\"},[_c('b-row',{attrs:{\"align-h\":\"center\"}},[_c('b-col',{attrs:{\"cols\":\"12\"}},[_c('listBlocks',{attrs:{\"liste_fields_check\":_vm.ListeFieldsCheck,\"liste_fields_display\":_vm.ListeFieldsDisplay,\"totalRows\":_vm.totalRows,\"isBusy\":_vm.isBusy,\"perPage\":_vm.perPage},on:{\"ev-change-pagination\":_vm.ChangePagination}})],1)],1)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <b-container fluid=\"md\">\n    <div>\n      <title-bar\n        :conf=\"{ col: true, text: 'Traitement' }\"\n        :id=\"id\"\n        :showDevis=\"false\"\n      ></title-bar>\n    </div>\n    <div class=\"appfom-container\">\n      <b-row align-h=\"center\">\n        <b-col class=\"\" cols=\"12\">\n          <listBlocks\n            :liste_fields_check=\"ListeFieldsCheck\"\n            :liste_fields_display=\"ListeFieldsDisplay\"\n            :totalRows=\"totalRows\"\n            :isBusy=\"isBusy\"\n            :perPage=\"perPage\"\n            @ev-change-pagination=\"ChangePagination\"\n          ></listBlocks>\n        </b-col>\n      </b-row>\n    </div>\n  </b-container>\n</template>\n\n<script>\nimport TitleBar from \"../TitleBar.vue\";\n\n//import axios from \"axios\";\nimport config from \"../config/config.js\";\n//import utilities from \"./Utilities\";\n//import NavLine from \"./NavLine.vue\";\nimport { mapState, mapGetters } from \"vuex\";\n//import ListTable from \"./ListTable.vue\";\nimport listBlocks from \"./blocks/listBlocks.vue\";\n//import pages from \"./pages.vue\";\n//import pages from \"./pages2.vue\";\n\nexport default {\n  components: { listBlocks, TitleBar },\n  props: {\n    id: {\n      type: String,\n      required: true,\n    },\n  },\n  data: () => {\n    return {\n      totalRows: 0,\n      isBusy: false,\n      perPage: 20,\n    };\n  },\n  watch: {\n    stepsId() {\n      this.datasBdOrLocalStorage();\n    },\n  },\n  mounted() {\n    this.loadDatas();\n    this.getTotalRows();\n  },\n  computed: {\n    ...mapState([\"traitementId\"]),\n    ...mapGetters([\"traitementFormItems\", \"form\"]),\n    ListeFieldsDisplay() {\n      const fieldsDisplay = [\n        {\n          label: \"Date\",\n          key: \"created\",\n          formatter: function (val) {\n            return config.getMysqlDateToFrench(val);\n          },\n        },\n        {\n          label: \"Que souhaitez vous faire\",\n          key: \"action\",\n          stickyColumn: true,\n          thStyle: { minWidth: \"170px\" },\n          tdClass: [\"bg-light\"],\n        },\n        {\n          label: \"Status\",\n          key: \"status\",\n          thStyle: { minWidth: \"140px\" },\n        },\n        {\n          label: \"Prix\",\n          key: \"price\",\n          thStyle: { minWidth: \"120px\" },\n          formatter: (value) => {\n            return value + \" â‚¬\";\n          },\n        },\n        {\n          label: \"Utilisateur\",\n          key: \"uid\",\n          thStyle: { minWidth: \"220px\" },\n        },\n      ];\n      for (const i in this.form.forms) {\n        const form = this.form.forms[i];\n        // console.log(\"etate : \", form.info.name, \"\\n\\n\");\n        for (const f in form.fields) {\n          const field = form.fields[f];\n          // console.log(field);\n          if (field.display_field) {\n            fieldsDisplay.push({\n              label: field.label,\n              key: field.name,\n              thStyle: { minWidth: \"220px\" },\n            });\n          }\n        }\n      }\n      return fieldsDisplay;\n    },\n    ListeFieldsCheck() {\n      const lists = [];\n      for (const i in this.ListeFieldsDisplay) {\n        lists.push(this.ListeFieldsDisplay[i].key);\n      }\n      return lists;\n    },\n  },\n  methods: {\n    deleteSteps(datas) {\n      var all = this.$store.state.allStepsDatas;\n      var r = all.indexOf(this.formDatas);\n      this.$emit(\"index-to-delete\", r);\n      console.log(\"de\", datas);\n      for (var i = all.length - 1; i >= 0; i--) {\n        if (i === r) {\n          all.splice(i, 1);\n          console.log(\"iiippp\");\n        }\n      }\n    },\n\n    saveToLocal() {\n      //var self = this;\n      //var datas = this.form;\n      config.prepareDatasToSave(this.form).then((val) => {\n        config.saveForm(val).then(() => {\n          //\n        });\n      });\n      /*\n      utilities.saveSteps(datas).then((reponse) => {\n        var forms = JSON.stringify(reponse[0].fields);\n        localStorage.setItem(\"allo\", JSON.stringify(forms));\n        console.log(\"savesteps: \", reponse);\n\n        axios\n          .post(\n            \"http://lesroisdelareno.kksa\" + \"/query-ajax/insert-update\",\n            reponse\n          )\n          .then(function (response) {\n            console.log(\"post response \", response);\n            self.$store.dispatch(\"setFormId\", self.id);\n          })\n          .catch(function (error) {\n            console.log(error);\n          });\n      });\n      /**/\n    },\n\n    resetValue() {\n      this.$store.getters.formDatas.selected = \"\";\n      this.$store.getters.formDatas.value = [];\n      console.log(\"prev\");\n    },\n    resetModal() {\n      //   this.formDatas.info.title = \"\";\n      //   this.titleState = null;\n      //   this.headerTitle = \"\";\n      //   this.headerState = null;\n    },\n    handleOk(bvModalEvt) {\n      // Prevent modal from closing\n      bvModalEvt.preventDefault();\n      // Trigger submit handler\n      this.handleSubmit();\n    },\n    handleSubmit(event) {\n      event.preventDefault();\n      // Exit when the form isn't valid\n      this.demo = true;\n\n      this.$nextTick(() => {\n        this.$bvModal.hide(\"modal-prevent-closing\");\n      });\n    },\n    getTotalRows() {\n      var datas =\n        \"select count(*) as nombres from `appformmanager_datas` where `appformmanager_forms` = \" +\n        this.id;\n      config.getData(datas).then((resp) => {\n        if (resp.data[0] && resp.data[0].nombres) {\n          this.totalRows = parseInt(resp.data[0].nombres);\n        }\n        console.log(\"resp[0].nombres : \", resp.data[0]);\n      });\n    },\n    loadDatas(pagination = 0) {\n      this.isBusy = true;\n      var pag = null;\n      if (pagination) pag = (pagination - 1) * this.perPage;\n      this.$store\n        .dispatch(\"loadTraitementDatas\", {\n          id: this.id,\n          pagination: pag,\n        })\n        .then(() => {\n          this.$store.dispatch(\"setTraitId\", this.id);\n          this.$store.dispatch(\"setFormId\", this.id);\n          this.isBusy = false;\n        });\n    },\n    ChangePagination(val) {\n      this.loadDatas(val);\n    },\n  },\n};\n</script>\n<style lang=\"scss\">\n.form-title {\n  letter-spacing: 2px;\n  margin-left: 10px;\n  font-weight: 600;\n}\n.block-button {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  justify-content: space-evenly;\n  button {\n    margin: 5px;\n  }\n}\n@import \"./affichage/traitement.scss\";\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Traitement.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Traitement.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Traitement.vue?vue&type=template&id=500262c8&\"\nimport script from \"./Traitement.vue?vue&type=script&lang=js&\"\nexport * from \"./Traitement.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Traitement.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Traitement.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}